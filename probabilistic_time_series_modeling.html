<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Selva Ulaganathan</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
    <!-- Place favicon.ico in the root directory -->


    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- <link rel="stylesheet" href="css/responsive.css"> -->

</head>

<body>
    <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

    <!-- header-start -->
    <header>
        <div class="header-area ">
            <div id="sticky-header" class="main-header-area">
                <div class="container-fluid p-0">
                    <div class="row align-items-center no-gutters">
                        <div class="col-xl-2 col-lg-2">
                            <div class="logo-img">
                                <a href="">
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-7 col-lg-7">
                            <div class="main-menu  d-none d-lg-block">
                                <nav>
                                    <ul id="navigation">
                                        <li><a class="" href="index.html#my-photo">home</a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a href="index.html#about-me">About Me</a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a href="index.html#popular-courses">Articles</a></li>
                                     <!-- <li><a href="#popular-courses">Projects & Expertise</a></li> --> 
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 d-none d-lg-block">
                            <div class="log_chat_area d-flex align-items-center">
                                <div class="live_chat_btn">
                                    <a class="boxed_btn_orange" href="mailto:ulag.selva@gmail.com?subject=Inquiry from Portfolio">
                                        <i class="flaticon-user"></i>
                                        <span>Reach Me</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="mobile_menu d-block d-lg-none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- header-end -->


        <!-- slider_area_start -->
        <div  id="my-photo" class="slider_area ">
                <div class="single_slider d-flex align-items-center justify-content-center slider_bg_1">
                    <div class="container">
                        <div class="row align-items-center justify-content-center">
                            
                            <div class="col-xl-16 col-md-12">
                                <div class="slider_info">
                                    <h3> Probabilistic Time Series Modeling </h3>
                                </div>
                            </div>

                            <div class="col-xl-6 col-md-6">
            
                                    <div class="col-sm"></div>
                                    <div class="col-sm text-center">
                                        <img src="img/articles/probabilistic_time_series/1-head.png" class="img-fluid rounded-circle" alt="My Head" heigh="550px"
                                            width="550px">
                                    </div>
                                    <div class="col-sm"></div>
            
                                </div>

                        </div>
                    </div>
                </div>
            </div>
            <!-- slider_area_end -->

    

        <!-- article_title_start -->
        <!--
   <div class="bradcam_area breadcam_bg overlay2">
        <h3>Probabilistic Time Series Modeling</h3>

        <div class="single_slider d-flex align-items-center justify-content-center">
            <div class="container">
                <div class="row align-items-center justify-content-center">
        <div class="col-xl-6 col-md-6">
                <div class="col-sm"></div>
                <div class="col-sm text-center">
                    <img src="img/articles/probabilistic_time_series/1.png" class="img-fluid rounded-circle" alt="My Head" heigh="550px"
                        width="550px">
                </div>
                <div class="col-sm"></div>
    
            </div>
        </div>
    </div>
    </div>
    </div>
-->


     <!-- article_title_end -->




       <!--================Blog Area =================-->
   <section class="blog_area single-post-area section-padding">
        <div class="container">
           <div class="row">
              <div class="col-lg-12 posts-list">
                 <div class="single-post">
                    <div class="blog_details">
                       <h2>Probabilistic Time Series Modeling with Amazon-MxNet-GluonTS
                       </h2>
                       <ul class="blog-info-link mt-3 mb-4">
                         <li><a href="index.html#popular-courses"><i class="fa fa-user"></i> Supervised Learning</a></li>
                         <li><a href="index.html#about-me"><i class="fa fa-user"></i> By: Selvakumar Ulaganthan, PhD</a></li>
                       </ul>
                        <h6>Disclaimer: The views expressed in this article are those of the Author's. They do not necessarily reflect the views of his employer. </h6>


                        <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                        <h2>Introduction</h2>


                        <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4"> Time Series analysis is one of the vital aspects of Artificial Intelligence and Machine Learning. It encompasses activities such as smoothing, forecasting, anomaly detection, etc. A data is often termed as 'time series' if the quantity being measured is varying over time (e.g., currency exchange rate over time, sales over time, energy usage over time, etc.). Given a time-varying quantity, predicting its path over the future has been around for a while. Many standard machine learning libraries have been offering solutions to address the 'point-estimate' of time series in the future horizon. However, nowadays there is a growing trend among businesses that they are often faced with questions like the following ones from their customers:
                            </font>
                        </p>


                        <div class="col-md-10 mt-sm-30">
                                <div class="">
                                    <ul class="unordered-list">
                                        <p> 
                                        <p style="font-weight:bolder;"></p>
                                        <font size="4"> 

                                        <li>How confident are you with your model?</li>
                                        <li>What extend (in terms of some business metrics) can we trust your model?</li>
                                        <li>What is the expected deviation of the forecast that your model is providing?</li>
                                        </li>
                                        </font>
                                        </p>
                                    </ul>
                                </div>
                            </div>





                       <p> 
                            <p style="font-weight:bolder;"></p>
                            <font size="4"> It becomes rather difficult to address these questions with the so called 'point-estimate' time series forecasting. Thus there is a growing research around finding explanations for the way machine learning models get to behave. Probabilistic time series modeling is one of the ways of addressing this challenge. In this respect, AWS open-sourced its Apache MxNet-based toolkit, GluonTS, for probabilistic time series analysis last year. GluonTS incorporates various deep-learning-based probabilistic time series modeling approaches both from AWS and the literature. In this article, I will demonstrate how we can very easily build a probabilistic time series model using GluonTS, and will discuss some of its salient features. </font>
                       </p>
  
                        <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                       <h2>GitHub</h2>

                       <p> 
                            <p style="font-weight:bolder;"></p>
                            <font size="4"> 
                                    You can find a working copy of a python script in my personal <a id="active" href="https://github.com/selvaHome/gluonts"> <b> GitHub </b></a> repository so that you can give a try for yourself right away.
                            </font>
                        </p>

                         <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                        <h2>Dataset</h2>

                        <p> 
                                <p style="font-weight:bolder;"></p>
                                <font size="4"> 
                                        As far as the dataset is concerned in GluonTS, we have three following choices:
                                 </font>
                        </p>


                        <div class="col-md-10 mt-sm-30">
                                <div class="">
                                    <ul class="unordered-list">
                                        <p> 
                                        <p style="font-weight:bolder;"></p>
                                        <font size="4"> 
                                        <li>Use an in-build time series dataset available in GluonTS</li>
                                        <li>Create an artificial time series dataset with GluonTS</li>
                                        <li>Adapt any external time series dataset for GluonTS</li>
                                        </li>
                                        </font>
                                        </p>
                                    </ul>
                                </div>
                        </div>



                        <p> 
                            <p style="font-weight:bolder;"></p>
                            <font size="4"> 
                                    GluonTS comes with a handful of in-build time series datasets covering various sectors such as finance, energy, public, etc. An artificial data (the term 'data' refers to time series data from now onwards throughout this article) can be generated using the synthetic data generation tool of GluonTS. Any external data can be converted into a dataset recognized by GluonTS using its <a id="active" href="https://github.com/awslabs/gluon-ts/blob/master/src/gluonts/dataset/common.py"> <b> ListDataset </b></a> class. For an example:
                            </font>
                        </p>


<pre class="brush: python"><code><div><ol>
# get the csv file as a dataframe 
raw_data = pd.read_csv("https://raw.githubusercontent.com/numenta/NAB/master/data/realTweets/Twitter_volume_AMZN.csv",header=0,index_col=0) 
                                                                
# convert the raw data into an object recognised by GluonTS 
# start: the starting index of the dataframe
# target: the actual time series data that we want to model
# freq: the frequency with which the data is collected
train_data = common.ListDataset([{"start": raw_data.index[0], "target": raw_data.value[:"2015-04-05 00:00:00"]}], freq="5min")                                   
</ol></div></code></pre>
<!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->



                        <p> 
                            <p style="font-weight:bolder;"></p>
                            <font size="4"> 
                                    I am going to use the <a id="active" href="https://github.com/awslabs/gluon-ts/blob/master/src/gluonts/dataset/repository/_gp_copula_2019.py"> <b> exchange_rate </b></a> dataset available in GluonTS for the purpose of demonstration. An in-build dataset has 3 main members: train, test & metadata. As the name suggests, the 'train' member has the training data. The 'test' member has both the training & the test data (an additional last window of the time series which is of length equal to 'prediction length' or 'forecast horizon' as it is known in time series modeling). The 'metadata' member has various information about the dataset (e.g., the frequency of the data collected, prediction length, features, etc.). The data can further be transformed or new features can be generated using the 'Transformation' feature of GluonTS. However, we will not exercise it for the sake of simplicity. The 'train' dataset is shown below.
                            </font>
                        </p>

<pre class="brush: python"><code><div><ol>
# get the financial data "exchange_rate"
gluon_data = get_dataset("exchange_rate", regenerate=True)
train_data = next(iter(gluon_data.train))
test_data = next(iter(gluon_data.test))
meta_data = gluon_data.metadata
                            
# visualize various members of the 'gluon_data.*'
print(train_data.keys())
print(test_data.keys())
print(meta_data)
</ol></div></code></pre>
<!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                                
                                

                        <div class="single_course text-center">
                                <div class="author_img">
                                        <img src="img/articles/probabilistic_time_series/2.png" alt="">
                                </div>
                                <h3>Training dataset</h3>
                        </div>




                        <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                        <h2>Modeling</h2>

                        <p> 
                            <p style="font-weight:bolder;"></p>
                            <font size="4"> 
                                    GluonTS comes with a variety of probabilistic time series modeling approaches. The available models can be observed <a id="active" href="https://github.com/awslabs/gluon-ts/tree/master/src/gluonts/model"> <b> here </b></a>. We will choose <a id="active" href="https://arxiv.org/abs/1704.04110"> <b> DeepAR </b></a> approach as it is also used to power the <a id="active" href="https://aws.amazon.com/forecast/"> <b> Amazon Forecast </b></a> service offered by AWS (optionally refer to my <a id="active" href="https://www.linkedin.com/pulse/aws-amazon-forecast-time-series-forecasting-selvakumar-ulaganathan/?trackingId=Hyeb7am04ru6fu6qxu%2By2g%3D%3D"> <b> article </b></a> on Amazon Forecast). However, it is mentioned that the implementation of DeepAR in GluonTS is not related to the one that is used in Amazon Forecast.
                            </font>
                        </p>




                        <p> 
                                <p style="font-weight:bolder;"></p>
                                <font size="4"> 
                                        GluonTS uses slightly different modeling conventions which may be confusing at first. A model before training is denoted as an 'Estimator'. The 'Estimator' object, however, represents details about the model such as coefficients, weights, etc. Estimator is configured by 'Trainer' object that defines how (e.g., usage of GPU/CPU, batch size, number of epochs, learning rate, etc.) the Estimator should be trained. The Estimator can be further trained with training data (i.e., the 'train' member of the dataset). The trained model is known as 'Predictor'. As expected, 'Predictor' is the one that will be used to get forecasts. The Predictor can further be serialised/deserialised (i.e., saved/loaded) using its member functions 'serialize & deserialize'. For an example:
                                </font>
                            </p>

<pre class="brush: python"><code><div><ol>
# create an Estimator with DeepAR
# an object of Trainer() class is used to customize Estimator
estimator = deepar.DeepAREstimator(freq=meta_data.freq, prediction_length=meta_data.prediction_length, trainer=Trainer(ctx="cpu", epochs=200, learning_rate=1e-4))
                                
# create a Predictor by training the Estimator with training dataset
predictor = estimator.train(training_data=training_data)
                                
# save the Predictor
predictor.serialize(Path("/folder_name/"))
</ol></div></code></pre>
<!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->




                        <p> 
                                <p style="font-weight:bolder;"></p>
                                <font size="4"> 
                                        If we have to include (time series) features during model building, these features have to be included in the 'train' & 'test' members of the dataset, and the corresponding parameters (e.g., 'use_feat_dynamic_real = True' in case of <a id="active" href="https://github.com/awslabs/gluon-ts/blob/master/src/gluonts/model/deepar/_estimator.py"> <b> DeepAREstimator </b></a>) should be set appropriately. More information on this can be obtained <a id="active" href="https://gluon-ts.mxnet.io/examples/extended_forecasting_tutorial/extended_tutorial.html"> <b> here </b></a> (the official documentation). It is important to note that many time series datasets (not just features) can be included to build a single model.
                                </font>
                            </p>

                        <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                            <h2>Forecasting</h2>

                        <p> 
                                <p style="font-weight:bolder;"></p>
                                <font size="4"> 
                                        Forecasts can be constructed as simple as shown below.
                                </font>
                            </p>



 <pre class="brush: python"><code><div><ol>
# make predictions
forecasts, ts_it = make_evaluation_predictions(dataset=testing_data, predictor=predictor, num_samples=200)                               
</ol></div></code></pre>
<!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                                                            
                                                            


                        <p> 
                                <p style="font-weight:bolder;"></p>
                                <font size="4"> 
                                        Forecasts are made for the complete 'forecast horizon' as it was mentioned during the configuration of the 'Estimator'. The model accuracy is reasonably good for the first attempt, however can be improved by paying more attention to the model hyper-parameters.
                                </font>
                            </p>



                        <!-- for spacing --> <div class=""><p></p><br></div> <!-- for spacing  -->
                        <div class="single_course text-center">
                                <div class="author_img">
                                        <img src="img/articles/probabilistic_time_series/3.png" alt="">
                                </div>
                                <h3>Forecasts</h3>
                        </div>
                        <!-- for spacing --> <div class=""><p></p><br></div> <!-- for spacing  -->




                        <p> 
                                <p style="font-weight:bolder;"></p>
                                <font size="4"> 
                                        One of the interesting features of GluonTS is to perform <a id="active" href="https://github.com/awslabs/gluon-ts/blob/master/src/gluonts/evaluation/backtest.py"> <b> backtesting </b></a> on its own in order to provide various performance metrics. There is no need to implement (of course, possible if needed) any of the <a id="active" href="https://github.com/awslabs/gluon-ts/blob/master/src/gluonts/evaluation/_base.py"> <b> error metrics </b></a> as most of them are already available in GluonTS. This eradicates the usual uncertainty over the bug-less implementation of various error metrics to make a feasible comparison across various models. We can create our own models using GluonTS too as it provides various founding blocks of the model building and evaluation. However, it is worth writing a separate article on that, thus we will stop here for the sake of simplicity.
                                </font>
                        </p>

                             
                    <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                        <h2>Highlights</h2>


                            <p> 
                                    <p style="font-weight:bolder;"></p>
                                    <font size="4"> 
                                            It is definitely an interesting and a very useful deep-learning (time series) library for experimentation. One can create a significant amount of variations of the existing state-of-the-art probabilistic (neural) time series models. As it is geared towards research experimentation, it has simplified various aspects of model building and testing as stated earlier. For an example, it has a very simple way of comparing GluonTS's models and their variations with <a id="active" href="https://gluon-ts.mxnet.io/api/gluonts/gluonts.model.prophet.html"> <b> Facebook's Prophet </b></a> time series package. However, there is not much information over how the model built using GluonTS can be taken to production. I guess we can make use of <a id="active" href="https://github.com/awslabs/multi-model-server"> <b> MxNet Multi Model Server </b></a>  or <a id="active" href="https://aws.amazon.com/sagemaker/"> <b> Amazon SageMaker </b></a>. I will probably write more about this in the coming months.
                                    </font>
                            </p>


                          <!-- for spacing --> <div class=""><p></p><br><p></p></div> <!-- for spacing  -->
                          <div class="col-sm text-center">
                                <a href="index.html#popular-courses" class="boxed_btn"><h3>Read More Articles</h3></a>
                            </div>

                        


                    </div>
                 </div>
              </div>
           </div>
        </div>
     </section>
     <!--================ Blog Area end =================-->





















    <!-- footer -->
    <footer class="footer footer_bg_1">
        <div class="footer_top">
            <div class="container">
                <div class="row">
                    <div class="col-xl-2 offset-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Articles
                            </h3>
                            <ul>
                                <li><a href="index.html#popular-courses">All Articles</a></li>
                            </ul>

                        </div>
                    </div>
                    <div class="col-xl-2 col-md-6 col-lg-2">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Resources
                            </h3>
                            <ul>
                                <li><a href="index.html#about-me"> About Me</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Address
                            </h3>
                            <ul>
                                    <li><a href="https://www.google.com/maps/place/Leuven/data=!4m2!3m1!1s0x47c160d05ebbdf85:0x40099ab2f4d5690?sa=X&ved=2ahUKEwjO0ILMyovnAhXBZlAKHemgBmgQ8gEwFnoECBIQBA"> Leuven-Belgium</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- footer -->



    <!-- JS here -->
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/gijgo.min.js"></script>

    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>

    <script src="js/main.js"></script>
</body>

</html>