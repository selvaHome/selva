<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <link rel="stylesheet" href="highlight/styles/default.css">
    <script src="highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <title>Selva Ulaganathan</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
    <!-- Place favicon.ico in the root directory -->


    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- <link rel="stylesheet" href="css/responsive.css"> -->

</head>

<body>
    <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

    <!-- header-start -->
    <header>
        <div class="header-area ">
            <div id="sticky-header" class="main-header-area">
                <div class="container-fluid p-0">
                    <div class="row align-items-center no-gutters">
                        <div class="col-xl-2 col-lg-2">
                            <div class="logo-img">
                                <a href="">
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-7 col-lg-7">
                            <div class="main-menu  d-none d-lg-block">
                                <nav>
                                    <ul id="navigation">
                                        <li><a class="" href="index.html#my-photo">home</a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <!-- <li><a class="active" href=""> </a></li> -->
                                        <li><a href="index.html#about-me">About Me</a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <!-- <li><a class="active" href=""> </a></li> -->
                                        <li><a href="index.html#popular-courses">Articles</a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <!-- <li><a class="active" href=""> </a></li> -->
                                        <li><a href="index.html#popular-projects">Projects</a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <li><a class="active" href=""> </a></li>
                                        <!-- <li><a class="active" href=""> </a></li>  -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 d-none d-lg-block">
                            <div class="log_chat_area d-flex align-items-center">
                                <div class="live_chat_btn">
                                    <a class="boxed_btn_orange"
                                        href="mailto:selva@selvai.com?subject=Inquiry from Portfolio">
                                        <i class="flaticon-user"></i>
                                        <span>Reach Me</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="mobile_menu d-block d-lg-none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- header-end -->


    <!-- slider_area_start -->
    <div id="my-photo" class="slider_area ">
        <div class="single_slider d-flex align-items-center justify-content-center slider_bg_1">
            <div class="container">
                <div class="row align-items-center justify-content-center">

                    <div class="col-xl-16 col-md-12">
                        <div class="slider_info">
                            <h3>Production Reinforcement Learning Made Easy</h3>
                        </div>
                    </div>

                    <div class="col-xl-10 col-md-6">

                        <div class="col-sm"></div>
                        <div class="col-sm text-center">
                            <img src="img/articles/rl.png" alt="My Head" height="350px" width="550px" class="">

                        </div>
                        <div class="col-sm"></div>

                    </div>


                </div>
            </div>
        </div>
    </div>
    <!-- slider_area_end -->





    <!--================Blog Area =================-->
    <section class="blog_area single-post-area section-padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 posts-list">
                    <div class="single-post">
                        <div class="blog_details">
                            <h2>Production Reinforcement Learning Made Easy
                            </h2>
                            <ul class="blog-info-link mt-3 mb-4">
                                <li><a href="index.html#popular-courses"><i class="fa fa-user"></i> Reinforcement
                                        Learning
                                    </a></li>
                                <!-- <li><a href="index.html#popular-courses"><i class="fa fa-user"></i> Data & Model Management
                                        </a></li> -->
                                <li><a href="index.html#about-me"><i class="fa fa-user"></i> By: Selvakumar Ulaganathan,
                                        PhD</a></li>
                            </ul>
                            <!--<h6>Disclaimer: The views expressed in this article are those of the Author's. They do not necessarily reflect the views of his employer. </h6> -->





                            <!-- Introduction -->
                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <h2>Streamlit</h2>
                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">

                                Reinforcement Learning is one of the exciting and promising areas of Artificial
                                Intelligence. Regardless of its potential, running a reinforcement learning model in
                                production is still a tedious task.
                                In other words, it has not become that common for a business whose expertise is not AI
                                to have many production running RL models as compared to classical (un)supervised
                                learning models.
                                However, the scenario is rapidly changing with a release of many tools.

                                <div class="col-md-10 mt-sm-30">
                                    <div class="">
                                        <ul class="unordered-list">
                                            <p style="font-weight:bolder;"></p>
                                            <font size="4">
                                                <li><strong>Data storage</strong> such as <strong>maintaining hundreds
                                                        of
                                                        tables</strong> resulting from AI models</li>
                                                <li><strong>Model storage</strong> as there is no way to bring the
                                                    models straight into the dashboarding applications</li>
                                                <li>Limitations on <strong>automating plots and dashboards</strong>
                                                    creation.</li>
                                            </font>
                                        </ul>
                                    </div>
                                </div>
                            </font>
                            </p>


                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">

                                RL is often used to solve problems where there is no one single optimal way of solving a
                                problem. Rather the problem can be solved in multiple ways with respect to various
                                (ever-changing) objectives and constraints. These kinds of problems often have
                                difficulties in using off-line data (a typical requirement of supervised learning
                                models) to solve their problems. They may need a system that can constantly interact
                                with the underlying source to solve the problem. Due to this nature, these problems pose
                                an additional challenge of either coding the problem or creating a digital-twin for the
                                problem. This is often referred to as an environment in RL terms. A typical RL setting
                                contains the following faculties (see Figure 1):

                                Environment
                                The coded problem which is to be monitored or controlled continuously. This incorporates
                                the features which define the nature of the problem (state), the means by which its
                                nature can be influenced (actions), the quatifyinable impact of such means which are
                                executed on the environment (reward).
                                State
                                An instance of the environment at a given time (i.e., a set of parameters that defines
                                the current nature of the environment).
                                Action
                                A set of actions that can be performed on the environment to influence the state of the
                                environment.
                                Reward
                                The quantity that will be outputted by the environment when an action is taken on it.
                                The business objectives and constraints of the problem are often incorporated in the
                                form of reward.
                                Agent
                                A RL faculty to propose a single or a set of actions given a state of the environment.
                                This faculty often incorporates key elements: a policy and a model.




                                Rumors aside, some of the salient features of Streamlit which I really like are:

                                <div class="col-md-10 mt-sm-30">
                                    <div class="">
                                        <ul class="unordered-list">
                                            <p style="font-weight:bolder;"></p>
                                            <font size="4">
                                                <li><strong>Pure Python</strong> is all I need</li>
                                                <li>Creation of plots and dashboards are extremely simple so that I can
                                                    <strong>focus more on the AI part</strong>
                                                </li>
                                                <li><strong>Ability to bring various AI models </strong> straight into
                                                    application to perform inference for example</li>
                                                <li><strong>Ability to automate the creation of plots and dashboards
                                                    </strong> so that I don't lose all the plots and the dashboards if
                                                    the
                                                    underlying database got affected for some reason</li>
                                                <li><strong>Ability to version control </strong> the codes behind
                                                    creating the plots and the dashboards</li>
                                                <li><strong>Ability to use various Python packages </strong> such as
                                                    Matplotlib, Plotly, Altair, etc. in order to create versatile
                                                    visualisations.</li>
                                            </font>
                                        </ul>
                                    </div>
                                </div>
                            </font>
                            </p>






                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <h2>Reinforcement Learning </h2>


                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">

                                The application model of Streamlit is extremely simple as it doesn't have complicated
                                callbacks.
                                The flow of components right from code development to visualisation is as follows:
                            </font>
                            </p>

                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">
                                <div class="col-md-10 mt-sm-30">
                                    <div class="">
                                        <ul class="unordered-list">
                                            <p style="font-weight:bolder;"></p>
                                            <font size="4">
                                                <li>Streamlit runs the python script from top to bottom</li>
                                                <li>Streamlit displays the contents of the app in a web browser</li>
                                                <li>During code development, once the python script is edited & saved,
                                                    the app in the web browser will be updated automatically</li>
                                                <li>During the user interaction with widgets of the app (e.g., button
                                                    clicks, etc.), the python code will be run by streamlit from top to
                                                    bottom for each interactive action of the user</li>
                                                <li>One can decorate regular python functions with <strong>
                                                        @streamlit.cache() </strong> decorator in order to avoid being
                                                    executed every time Streamlit runs the python script. This may
                                                    reduce the computational cost associated with running the whole
                                                    script again and again.
                                                    This allows one to speed up the heavy jobs such as database
                                                    connections, downloading ML models, etc.
                                                    However, caching in streamlit works with respect to certain
                                                    conditions. See <a id="cache"
                                                        href="https://docs.streamlit.io/en/latest/caching.html"><b>here</b></a>.
                                                </li>
                                            </font>
                                        </ul>
                                    </div>
                                </div>
                            </font>
                            </p>



                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <div class="single_course text-center">
                                <div class="author_img">
                                    <img src="img/articles/rl.png" alt="" height="850px" width="850px">
                                </div>
                                <h4>Faculties of Reinforcement Learning</h4>
                            </div>
                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->





                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <h2>Difficulties </h2>


                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">

                                If we have to develop a RL solution to a problem from scratch, the problem has to be
                                first coded as an environment. If the problem has an existing simulator which can take
                                on actions and can throw out state and reward, one can move to the development of RL
                                agent immediately. If not one has to first formulate the problem as an Environment. The
                                following tools are often used for this for quite some time:
                                OpenAI Gym
                                ..

                                The next big step is to use one of the famous machine learning frameworks (such as
                                PyTorch, Tensorflow, etc.) to code the RL agent (i.e., the policy & the RL model) and
                                get them integrated with the environment. Once such an integration is done, the agent
                                can be trained by continual interaction with the environment. Once the training is
                                carried out, both the policy and the model are to be integrated with an API app to serve
                                via endpoints. However, it's much easier said than done. Understanding the training and
                                the behavior of RL agents is often cumbersome. Besides, creating a development
                                environment and a production environment (i.e., docker image for an example) with
                                necessary tools is often time consuming. Additionally, one has to focus on the serving
                                part of the agent such as load balancing, scaling, etc.

                            </font>
                            </p>

                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">
                                <div class="col-md-10 mt-sm-30">
                                    <div class="">
                                        <ul class="unordered-list">
                                            <p style="font-weight:bolder;"></p>
                                            <font size="4">
                                                <li>Although there are some work-arounds, I couldn't find an easy way to
                                                    include user authentications in the community version.
                                                    Although this may not be an issue with exploration-centric AI
                                                    applications within small teams, but a must for user-centric
                                                    deployments</li>
                                                <li>Layout customisation is still not very obvious, and rather difficult
                                                    for multi-page applications</li>
                                                <li>Adding custom components (e.g., adding a Javascript code into the
                                                    python code) into the app is still yet to come.</li>
                                                <li>Streamlit caching is still not very easy to understand and use.
                                                    Simplifying the caching feature along with accompanying
                                                    documentation would be nice to have.</li>
                                            </font>
                                        </ul>
                                    </div>
                                </div>
                            </font>
                            </p>



                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <h2>Changing Landscape</h2>

                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">
                                One of the tools which I encountered recently is Ray RLLib. It is an open source tool
                                developed by AnyLogic and is a part of much wider package Ray with capabilities to build
                                ML models other than RL too. It's a wonderful tool to quickly experiment with the RL
                                solution and bring it to production. It has components to serve the agent without
                                actually building a separate app as such (e.g., a flask app). It has support to scale
                                the deployment across many clusters easily. It supports a wide variety of RL algorithms
                                with both Tensorflow and PyTorch serving as backend to build raw machine learning models
                                (e.g., neural networks). As long as the problem is coded as environment with one of the
                                supported frameworks (e.g., OpenAI gym), experimenting with a RL solution and bringing
                                it to the serving become much easier than building everything from scratch. However, it
                                is true that it can be still taunting to go through these processes to get the RL agent
                                running in production. There is an interesting solution for that too: the AWS SageMaker
                                RL.



                                The SageMaker RL is a managed RL service from AWS. It has support for many RL frameworks
                                such as Ray RLLib, RL Coach and OpenAI Baselines with many deep learning backends such
                                as TensorFlow, PyTorch, MxNet, etc. Once the problem can be coded as an environment and
                                the right data is in flow, it becomes much easier to train and deploy a RL agent in
                                simply a series of commands. This way one can focus on the actual problem which (1)
                                coding the problem as accurately as possible (2) experimenting various scopes and
                                complexities of the problem to be solved (3) using the built RL agent in the right
                                context to solve the actual use-case.

                            </font>
                            </p>

                            <pre class="brush: shell"><code><div><ol>
                            # pip installation
                            pip install streamlit
                                                    
                            # run the application in terminal
                            streamlit run app.py
                            </ol></div></code></pre>





                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">
                                Streamlit makes it extremely easy to create various building blocks of AI/ML
                                Applications.
                                For example, creating a line chart from a dataframe can be as simple as shown below.
                            </font>
                            </p>

                            <pre class="brush: python"><code><div><ol>
                            # creating line chart with a dataframe
                            st.line_chart(item_metrics, width=1300, height=700)
                            </ol></div></code></pre>



                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">
                                Creating a plotly figure can be slightly more involved. However, it is simply due to the
                                commands needed for plotly, but not for Streamlit.
                                However, as the pandas dataframe plots can now use the plotly backend from the recent
                                version of Pandas, handling of plotly figures will become much easier
                                in Streamlit too.
                            </font>
                            </p>

                            <pre class="brush: python"><code><div><ol>
                            # Plotly scatter plot data assignment
                            data = [
                            go.Scatter(
                                x=ts_past['date'].tail(30),
                                y=ts_past[feat_names[feat_name]].tail(30), name="past: actual time-series"),
                            go.Scatter(
                                x=pd.date_range(start=ts_future.start_date,
                                                periods=len(ts_future.samples[0]), freq='D'),
                                y=np.median(ts_future.samples, axis=0), name="forecast: median")
                            ]
                    
                            # layout assignment
                            layout_attendance = go.Layout(
                                height=700, width=1300,
                                legend=dict(orientation="v"),
                                xaxis={'title': "Date"},
                                yaxis={'title': feat_name}
                            )
                    
                            # plot
                            fig_marks = go.Figure(data=data_marks, layout=layout_attendance)
                            st.write(fig_marks)
                            </ol></div></code></pre>


                            <p>
                            <p style="font-weight:bolder;"></p>
                            <font size="4">
                                The following video shows the <a id="doc"
                                    href="https://evening-depths-40056.herokuapp.com"><b>predictive maintenance
                                        multi-page app</b></a> that I developed using Streamlit.
                                The application is deployed in Heroku, and can be accessed with a credential "guest_pm"
                                (both username and password).
                                As the application is hosted under free quota from Heroku, the first load often takes
                                some time.
                            </font>
                            </p>


                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <div class="single_course text-center">
                                <video width="1100" height="550" controls autoplay loop>
                                    <source src="img/articles/streamlit/streamlit_demo_fast.mp4" type="video/mp4">
                                </video>
                            </div>


















                            <!-- Read More Articles -->
                            <!-- for spacing -->
                            <div class="">
                                <p></p><br>
                                <p></p>
                            </div> <!-- for spacing  -->
                            <div class="col-sm text-center">
                                <a href="index.html#popular-courses" class="boxed_btn">
                                    <h3>Read More Articles</h3>
                                </a>
                            </div>





                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--================ Blog Area end =================-->





















    <!-- footer -->
    <footer class="footer footer_bg_1">
        <div class="footer_top">
            <div class="container">
                <div class="row">
                    <div class="col-xl-2 offset-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Articles
                            </h3>
                            <ul>
                                <li><a href="index.html#popular-courses">All Articles</a></li>
                            </ul>

                        </div>
                    </div>
                    <div class="col-xl-2 col-md-6 col-lg-2">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Resources
                            </h3>
                            <ul>
                                <li><a href="index.html#about-me"> About Me</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Address
                            </h3>
                            <ul>
                                <li><a
                                        href="https://www.google.com/maps/place/Leuven/data=!4m2!3m1!1s0x47c160d05ebbdf85:0x40099ab2f4d5690?sa=X&ved=2ahUKEwjO0ILMyovnAhXBZlAKHemgBmgQ8gEwFnoECBIQBA">
                                        Leuven-Belgium</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- footer -->



    <!-- JS here -->
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/gijgo.min.js"></script>

    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>

    <script src="js/main.js"></script>
</body>

</html>